
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>CVSS – Collapsible Impact</title>
<style>
  :root{
    --bg:#0f1318; --card:#161b22; --text:#e6edf3; --muted:#9aa4b2; --border:#2b3642;
    --chip:#222a35; --chip-active:#2e3a49;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font:14px/1.45 system-ui,Segoe UI,Roboto,Arial;
    display:flex; justify-content:center; padding:28px;
  }
  .wrap{width:760px; max-width:100%}
  h1{font-size:22px;margin:0 0 14px}

  /* card */
  .card{background:var(--card); border:1px solid var(--border); border-radius:12px; padding:10px; margin:0 0 18px;}

  /* details (collapsible sections) */
  details{border:1px solid var(--border); border-radius:10px; overflow:hidden; margin:10px 0; background:#131922;}
  summary{
    list-style:none; cursor:pointer; padding:12px 14px;
    display:flex; align-items:center; gap:10px; font-weight:700; background:#161b22;
  }
  summary::marker{display:none}
  details > summary::after{content:"▾"; margin-left:auto; color:var(--muted); transition:transform .15s ease;}
  details[open] > summary::after{transform:rotate(-180deg)}
  .dd-list{padding:12px 14px; border-top:1px solid var(--border); background:#131922}

  /* chips (radio) */
  .option-group{margin:12px 0}
  .option-group strong{display:block;margin:0 0 6px}
  .chips label{display:inline-block;margin:4px}
  .chips input[type=radio]{display:none}
  .chips input[type=radio] + span{
    display:inline-block; padding:7px 12px; border:1px solid var(--border);
    border-radius:7px; background:var(--chip); color:#cbd5e1; cursor:pointer;
  }
  .chips input[type=radio]:checked + span{
    background:var(--chip-active); color:#fff; border-color:#4a5a6b;
  }

  /* checkbox grid */
  .ck-list{display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:8px 16px}
  .ck{display:flex; align-items:center; gap:8px}
  .ck input{width:16px; height:16px; accent-color:#4a90e2}

  /* Impact toggles (HTML-only, no JS) */
  .toggle{
    border:1px dashed var(--border);
    border-radius:10px;
    padding:10px;
    margin:10px 0;
    background:#121821;
    position:relative;
  }
  
  .toggle > input[type="checkbox"]{
    position:absolute; 
    opacity:0;        
  }

  .toggle > label{
    display:flex; align-items:center; gap:10px;
    cursor:pointer; font-weight:700;
    padding:10px 12px; border-radius:8px;
    background:#161b22; border:1px solid var(--border);
    user-select:none;
  }

  .toggle .cb{
    width:16px; height:16px; border:1px solid var(--border);
    border-radius:4px; background:#0f1318; position:relative;
  }
  .toggle > input[type="checkbox"]:checked + label .cb::after{
    content:""; position:absolute; inset:3px; border-radius:2px; background:#4a90e2;
  }

  .toggle > label::after{
    content:"▸"; margin-left:auto; color:var(--muted); transition:transform .15s ease;
  }
  .toggle > input[type="checkbox"]:checked + label::after{
    content:"▾"; transform:rotate(0);
  }

  .panel{display:none; padding:12px 8px 0}
  .toggle > input[type="checkbox"]:checked ~ .panel{display:block}

  .nested{margin:8px 0 0 0}
  .nested summary{background:#171e28; padding:10px 12px; font-weight:700}
  .nested .dd-list{background:#10161f}

  .ck-list{display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:8px 16px}
  .ck{display:flex; align-items:center; gap:8px}
  .ck input{width:16px; height:16px; accent-color:#4a90e2}

  /* Other Common Attack section */
.other-impact {
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  margin: 10px 0;
  background: #131922;
}
.other-impact summary {
  list-style: none;
  cursor: pointer;
  padding: 12px 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 700;
  background: #161b22;
}
.other-impact summary::after {
  content: "▾";
  margin-left: auto;
  color: var(--muted);
  transition: transform .15s ease;
}
.other-impact[open] summary::after {
  transform: rotate(-180deg);
}
.other-impact .ck-list {
  padding: 12px 14px;
  border-top: 1px solid var(--border);
  background: #131922;
}

.cvss-score {
    margin-top: 15px;
    font-weight: bold;
}
#score {
    width: 100px;
    text-align: center;
    font-size: 1.2em;
}
    
.badge{display:inline-block;margin-left:8px;padding:4px 8px;border:1px solid var(--border);border-radius:6px;background:#1b2430;color:#cbd5e1;font-weight:600}
.badge.na{background:#2a2f36}
.badge.info{background:#0557ae}
.badge.low{background:#54a02b}
.badge.med{background:#cf8825}
.badge.high{background:#9a1c1c}
.badge.crit{background:#f30a0a}
</style>
</head>
<body>
<div class="wrap">
<h1>CVSS Calculator</h1>
<!-- ROOT WRAPPER -->
<details class="card">
<summary>CVSS Calculator</summary>
<div class="dd-list">
<!-- Standers (collapsed list) -->
<details>
<summary>Standers</summary>
<div class="dd-list">
<!-- User Role -->
<div class="option-group">
<strong>Authentication Required</strong>
<div class="chips">
<label><input name="auth" type="radio" value="N"/><span>None</span></label>
<label><input name="auth" type="radio" value="L"/><span>User</span></label>
<label><input name="auth" type="radio" value="H"/><span>Admin</span></label>
</div>
</div>
<!-- Attack Complexity -->
<div class="option-group">
<strong>Attack Complexity</strong>
<div class="chips">
<label><input name="complexity" type="radio" value="L"/><span>Low</span></label>
<label><input name="complexity" type="radio" value="M"/><span>Medium</span></label>
<label><input name="complexity" type="radio" value="H"/><span>High</span></label>
</div>
</div>
<!-- User Interaction -->
<div class="option-group">
<strong>User Interaction</strong>
<div class="chips">
<label><input name="interaction" type="radio" value="N"/><span>None (N)</span></label>
<label><input name="interaction" type="radio" value="R"/><span>Required (R)</span></label>
</div>
</div>
</div>
</details>
<!-- Impact (collapsed master) -->
<details>
<summary>Impact</summary>
<!-- Confidentiality -->
<div class="toggle">
<input id="imp-c" type="checkbox"/>
<label for="imp-c">
<span aria-hidden="true" class="cb"></span>
<span>Confidentiality</span>
</label>
<div class="panel">
<!-- Personal Information -->
<details class="nested">
<summary>Personal Information</summary>
<div class="dd-list ck-list">
<label class="ck"><input data-label="Full Name" type="checkbox"/> <span>Full Name</span></label>
<label class="ck"><input data-label="Username" type="checkbox"/> <span>Username</span></label>
<label class="ck"><input data-label="National ID" type="checkbox"/> <span>National ID</span></label>
<label class="ck"><input data-label="Mobile Number" type="checkbox"/> <span>Mobile Number</span></label>
<label class="ck"><input data-label="Email" type="checkbox"/> <span>Email</span></label>
<label class="ck"><input data-label="Personal Address / Location Data" type="checkbox"/> <span>Personal Address / Location Data</span></label>
<label class="ck"><input data-label="Financial Information (Bank account, IBAN)" type="checkbox"/> <span>Financial Information (Bank account, IBAN)</span></label>
<label class="ck"><input data-label="Date of Birth / Age" type="checkbox"/> <span>Date of Birth / Age</span></label>
<label class="ck"><input data-label="Profile Picture / Signature" type="checkbox"/> <span>Profile Picture / Signature</span></label>
<label class="ck"><input data-label="Security Questions &amp; Answers" type="checkbox"/> <span>Security Questions &amp; Answers</span></label>
<label class="ck"><input data-label="Emergency / Recovery Contact" type="checkbox"/> <span>Emergency / Recovery Contact</span></label>
<label class="ck"><input data-label="Device Identifiers (IMEI, Device ID)" type="checkbox"/> <span>Device Identifiers (IMEI, Device ID)</span></label>
<label class="ck"><input data-label="Social Media Links" type="checkbox"/> <span>Social Media Links</span></label>
</div>
</details>
<!-- Internal Company IDs -->
<details class="nested">
<summary>Internal Company IDs</summary>
<div class="dd-list ck-list">
<label class="ck"><input data-label="Full Name" type="checkbox"/> <span>Full Name</span></label>
<label class="ck"><input data-label="Employee ID" type="checkbox"/> <span>Employee ID</span></label>
<label class="ck"><input data-label="National ID" type="checkbox"/> <span>National ID</span></label>
<label class="ck"><input data-label="Phone Number" type="checkbox"/> <span>Phone Number</span></label>
<label class="ck"><input data-label="Email" type="checkbox"/> <span>Email</span></label>
<label class="ck"><input data-label="Internal Email Address" type="checkbox"/> <span>Internal Email Address</span></label>
<label class="ck"><input data-label="Customer / Supplier ID" type="checkbox"/> <span>Customer / Supplier ID</span></label>
<label class="ck"><input data-label="Ticket / Case ID" type="checkbox"/> <span>Ticket / Case ID</span></label>
<label class="ck"><input data-label="Contract / Invoice ID" type="checkbox"/> <span>Contract / Invoice ID</span></label>
<label class="ck"><input data-label="Project / Asset Code" type="checkbox"/> <span>Project / Asset Code</span></label>
<label class="ck"><input data-label="System Usernames (SAP/ERP/CRM)" type="checkbox"/> <span>System Usernames (SAP/ERP/CRM)</span></label>
<label class="ck"><input data-label="Device Serial Numbers / Asset Tags" type="checkbox"/> <span>Device Serial Numbers / Asset Tags</span></label>
</div>
</details>
<!-- Tokens and Sessions -->
<details class="nested">
<summary>Tokens and Sessions</summary>
<div class="dd-list ck-list">
<label class="ck"><input data-label="JWT Token" type="checkbox"/> <span>JWT Token</span></label>
<label class="ck"><input data-label="Session Token" type="checkbox"/> <span>Session Token</span></label>
<label class="ck"><input data-label="Refresh Token" type="checkbox"/> <span>Refresh Token</span></label>
<label class="ck"><input data-label="Password Reset Tokens / Magic Links" type="checkbox"/> <span>Password Reset Tokens / Magic Links</span></label>
<label class="ck"><input data-label="API Keys / OAuth Tokens" type="checkbox"/> <span>API Keys / OAuth Tokens</span></label>
<label class="ck"><input data-label="Signed / Pre-Signed URLs" type="checkbox"/> <span>Signed / Pre-Signed URLs</span></label>
</div>
</details>
<!-- Other Common Attack -->
<details class="nested">
<summary>Other Common Attacks</summary>
<div class="dd-list ck-list">
<label class="ck"><input data-label="Bills / Invoices" type="checkbox"/> <span>Bills / Invoices</span></label>
<label class="ck"><input data-label="Commercial Register ID" type="checkbox"/> <span>Commercial Register ID</span></label>
<label class="ck"><input data-label="Password in Hash" type="checkbox"/> <span>Password in Hash</span></label>
<label class="ck"><input data-label="Password in Clear Text" type="checkbox"/> <span>Password in Clear Text</span></label>
<label class="ck"><input data-label="Transaction Details / Order History" type="checkbox"/> <span>Transaction Details / Order History</span></label>
<label class="ck"><input data-label="Notification (Read Only)" type="checkbox"/> <span>Notification (Read Only)</span></label>
<label class="ck"><input data-label="Shipment ID" type="checkbox"/> <span>Shipment ID</span></label>
<label class="ck"><input data-label="Database Backups" type="checkbox"/> <span>Database Backups</span></label>
<label class="ck"><input data-label="Configuration Files / .env" type="checkbox"/> <span>Configuration Files / .env</span></label>
<label class="ck"><input data-label="Internal Documentation" type="checkbox"/> <span>Internal Documentation</span></label>
<label class="ck"><input data-label="Logs" type="checkbox"/> <span>Logs</span></label>
<label class="ck"><input data-label="Internal IP Disclosure" type="checkbox"/> <span>Internal IP Disclosure</span></label>
<label class="ck"><input data-label="Google Apikey" type="checkbox"/> <span>Google Apikey</span></label>
<label class="ck"><input data-label="Financial statements" type="checkbox"/> <span>Financial statements</span></label>
<label class="ck"><input data-label=".git Repository" type="checkbox"/> <span>.git Repository</span></label>
<label class="ck"><input data-label="SQL Dump Files (.sql, .db, .sqlite)" type="checkbox"/> <span>SQL Dump Files (.sql, .db, .sqlite)</span></label>
<label class="ck"><input data-label="Backup Archives (.zip, .tar.gz, .bak)" type="checkbox"/> <span>Backup Archives (.zip, .tar.gz, .bak)</span></label>
<label class="ck"><input data-label="phpMyAdmin Config Files" type="checkbox"/> <span>phpMyAdmin Config Files</span></label>
</div>
</details>
</div>
</div>
<!-- Integrity -->
<div class="toggle">
<input id="imp-i" type="checkbox"/>
<label for="imp-i">
<span aria-hidden="true" class="cb"></span>
<span>Integrity</span>
</label>
<div class="panel">
<div class="ck-list">
<label class="ck"><input data-label="Edit Account" type="checkbox"/> <span>Edit Account</span></label>
<label class="ck"><input data-label="Change Order / Shipment Status" type="checkbox"/> <span>Change Order / Shipment Status</span></label>
<label class="ck"><input data-label="Modify Transaction Details" type="checkbox"/> <span>Modify Transaction Details</span></label>
<label class="ck"><input data-label="Update Configuration Settings" type="checkbox"/> <span>Update Configuration Settings</span></label>
<label class="ck"><input data-label="Notification (Read/Write)" type="checkbox"/> <span>Notification (Read/Write)</span></label>
<label class="ck"><input data-label="Bypass Business Logic" type="checkbox"/> <span>Bypass Business Logic</span></label>
<label class="ck"><input data-label="Privilege Escalation" type="checkbox"/> <span>Privilege Escalation</span></label>
<label class="ck"><input data-label="Price Manipulation / Discount Abuse" type="checkbox"/> <span>Price Manipulation / Discount Abuse</span></label>
<label class="ck"><input data-label="Quantity Manipulation in Orders" type="checkbox"/> <span>Quantity Manipulation in Orders</span></label>
<label class="ck"><input data-label="Balance / Points Modification" type="checkbox"/> <span>Balance / Points Modification</span></label>
<label class="ck"><input data-label="Approval Workflow Tampering" type="checkbox"/> <span>Approval Workflow Tampering</span></label>
<label class="ck"><input data-label="OTP Bypass / Reuse" type="checkbox"/> <span>OTP Bypass / Reuse</span></label>
<label class="ck"><input data-label="Invoice / Receipt Modification" type="checkbox"/> <span>Invoice / Receipt Modification</span></label>
<label class="ck"><input data-label="Product Availability Manipulation" type="checkbox"/> <span>Product Availability Manipulation</span></label>
<label class="ck"><input data-label="Access Control Policy Tampering" type="checkbox"/> <span>Access Control Policy Tampering</span></label>
<label class="ck"><input data-label="Coupon / Voucher Exploitation" type="checkbox"/> <span>Coupon / Voucher Exploitation</span></label>
<label class="ck"><input data-label="API Request Parameter Tampering" type="checkbox"/> <span>API Request Parameter Tampering</span></label>
<label class="ck"><input data-label="Stored Data Tampering" type="checkbox"/> <span>Stored Data Tampering</span></label>
</div>
</div>
</div>
<!-- Availability -->
<div class="toggle">
<input id="imp-a" type="checkbox"/>
<label for="imp-a">
<span aria-hidden="true" class="cb"></span>
<span>Availability</span>
</label>
<div class="panel">
<div class="ck-list">
<label class="ck"><input data-label="Delete Account" type="checkbox"/> <span>Delete Account</span></label>
<label class="ck"><input data-label="Delete Shipment ID" type="checkbox"/> <span>Delete Shipment ID</span></label>
<label class="ck"><input data-label="Cancel Orders / Disable Access" type="checkbox"/> <span>Cancel Orders / Disable Access</span></label>
<label class="ck"><input data-label="Database Wipe" type="checkbox"/> <span>Database Wipe</span></label>
<label class="ck"><input data-label="Service Downtime (DoS/DDoS)" type="checkbox"/> <span>Service Downtime (DoS/DDoS)</span></label>
<label class="ck"><input data-label="Data Corruption" type="checkbox"/> <span>Data Corruption</span></label>
<label class="ck"><input data-label="Account Suspension / Lockout or Blocked" type="checkbox"/> <span>Account Suspension / Lockout or Blocked</span></label>
<label class="ck"><input data-label="Service Degradation" type="checkbox"/> <span>Service Degradation</span></label>
<label class="ck"><input data-label="File Deletion" type="checkbox"/> <span>File Deletion</span></label>
<label class="ck"><input data-label="Queue Overload / Resource Exhaustion" type="checkbox"/> <span>Queue Overload / Resource Exhaustion</span></label>
<label class="ck"><input data-label="Critical Process Termination" type="checkbox"/> <span>Critical Process Termination</span></label>
<label class="ck"><input data-label="Backup Deletion" type="checkbox"/> <span>Backup Deletion</span></label>
<label class="ck"><input data-label="Job Cancellation" type="checkbox"/> <span>Job Cancellation</span></label>
<label class="ck"><input data-label="Rate Limit Abuse (Causing Service Denial)" type="checkbox"/> <span>Rate Limit Abuse (Causing Service Denial)</span></label>
<label class="ck"><input data-label="Scheduler / Cron Task Disruption" type="checkbox"/> <span>Scheduler / Cron Task Disruption</span></label>
</div>
</div>
</div>
</details>
<!-- Cvss-Score-->
<div class="cvss-score">
<label for="score">Score:</label>
<input id="score" readonly="" type="text"/>
<span id="levelBadge"></span><span id="cvssBadge"></span></div>
</div></details>
</div>
<script>
    // Editable weights per item (default 0). Change numbers as you like (e.g., 3, 8, 10...)
    const checkboxValues = {
    // Confidentiality
    "Full Name": 1,
    "Username": 1,
    "National ID": 6,
    "Mobile Number": 1,
    "Email": 1,
    "Personal Address / Location Data": 1,
    "Financial Information (Bank account, IBAN)": 1,
    "Date of Birth / Age": 1,
    "Profile Picture / Signature": 1,
    "Security Questions & Answers": 1,
    "Emergency / Recovery Contact": 1,
    "Device Identifiers (IMEI, Device ID)": 1,
    "Social Media Links": 1,
    "Employee ID": 1,
    "Phone Number": 1,
    "Internal Email Address": 1,
    "Customer / Supplier ID": 1,
    "Ticket / Case ID": 1,
    "Contract / Invoice ID": 1,
    "Project / Asset Code": 1,
    "System Usernames (SAP/ERP/CRM)": 1,
    "Device Serial Numbers / Asset Tags": 1,
    "JWT Token": 1,
    "Session Token": 1,
    "Refresh Token": 1,
    "Password Reset Tokens / Magic Links": 1,
    "API Keys / OAuth Tokens": 1,
    "Signed / Pre-Signed URLs": 1,
    "Bills / Invoices": 1,
    "Commercial Register ID": 1,
    "Password in Hash": 1,
    "Password in Clear Text": 1,
    "Transaction Details / Order History": 1,
    "Notification (Read Only)": 1,
    "Shipment ID": 1,
    "Database Backups": 1,
    "Configuration Files / .env": 1,
    "Internal Documentation": 1,
    "Logs": 1,
    "Internal IP Disclosure": 1,
    "Google Apikey": 1,
    "Financial statements": 1,
    ".git Repository": 1,
    "SQL Dump Files (.sql, .db, .sqlite)": 1,
    "Backup Archives (.zip, .tar.gz, .bak)": 1,
    "phpMyAdmin Config Files": 1,
    
// Integrity
    "Edit Account": 1,
    "Change Order / Shipment Status": 1,
    "Modify Transaction Details": 1,
    "Update Configuration Settings": 1,
    "Notification (Read/Write)": 1,
    "Bypass Business Logic": 1,
    "Privilege Escalation": 1,
    "Price Manipulation / Discount Abuse": 1,
    "Quantity Manipulation in Orders": 1,
    "Balance / Points Modification": 1,
    "Approval Workflow Tampering": 1,
    "OTP Bypass / Reuse": 1,
    "Invoice / Receipt Modification": 1,
    "Product Availability Manipulation": 1,
    "Access Control Policy Tampering": 1,
    "Coupon / Voucher Exploitation": 1,
    "API Request Parameter Tampering": 1,
    "Stored Data Tampering": 1,
    
// Availability
    "Delete Account": 1,
    "Delete Shipment ID": 1,
    "Cancel Orders / Disable Access": 1,
    "Database Wipe": 1,
    "Service Downtime (DoS/DDoS)": 1,
    "Data Corruption": 1,
    "Account Suspension / Lockout or Blocked": 1,
    "Service Degradation": 1,
    "File Deletion": 1,
    "Queue Overload / Resource Exhaustion": 1,
    "Critical Process Termination": 1,
    "Backup Deletion": 1,
    "Job Cancellation": 1,
    "Rate Limit Abuse (Causing Service Denial)": 1,
    "Scheduler / Cron Task Disruption": 1
};

    function getWeight(label){
        if (Object.prototype.hasOwnProperty.call(checkboxValues, label)) return Number(checkboxValues[label]) || 0;
        return 0; // anything not listed counts as 0
    }

    function classifyCustom(score){
        if (score === 0) return {label:"NA", cls:"na"};
        if (score >= 1 && score <= 2.9) return {label:"Informational", cls:"info"};
        if (score >= 3 && score <= 3.9) return {label:"Low", cls:"low"};
        if (score >= 4 && score <= 6.9) return {label:"Medium", cls:"med"};
        if (score >= 7 && score <= 8.9) return {label:"High", cls:"high"};
        if (score >= 9) return {label:"Critical", cls:"crit"};
        return {label:"NA", cls:"na"};
    }

    function classifyCvss(score){
        if (score === 0) return {label:"CVSS v3.1", cls:"na"};
        if (score > 0 && score <= 3.9) return {label:"Low (CVSS v3.1)", cls:"low"};
        if (score >= 4.0 && score <= 6.9) return {label:"Medium (CVSS v3.1)", cls:"med"};
        if (score >= 7.0 && score <= 8.9) return {label:"High (CVSS v3.1)", cls:"high"};
        if (score >= 9.0) return {label:"Critical (CVSS v3.1)", cls:"crit"};
        return {label:"None (CVSS v3.1)", cls:"na"};
    }

    function setBadge(el, data){
        if (!el) return;
        el.className = "badge " + data.cls;
        el.textContent = data.label;
    }

    function calculateScore() {
        let score = 0;

        // Gate: must select the three standards
        const auth = document.querySelector('input[name="auth"]:checked');
        const complexity = document.querySelector('input[name="complexity"]:checked');
        const interaction = document.querySelector('input[name="interaction"]:checked');
        const allSelected = !!auth && !!complexity && !!interaction;

        if (allSelected) {
            // Sum only .ck-list items
            document.querySelectorAll('.ck-list input[type="checkbox"]:checked').forEach(item => {
                const label = item.getAttribute("data-label") || "";
                score += getWeight(label);
            });

            // Deductions/bonuses
            const av = auth.value.toLowerCase();
            if (av === 'user' || av === 'l') score -= 2;
            if (av === 'admin' || av === 'h') score -= 4;

            const cv = complexity.value.toLowerCase();
            if (cv === 'medium' || cv === 'm') score -= 3;
            if (cv === 'high' || cv === 'h') score -= 5;

            const iv = interaction.value.toLowerCase();
            if (iv === 'required' || iv === 'r') score -= 3;

            // Clamp 0..10
            score = Math.max(0, Math.min(10, score));
        } else {
            score = 0;
        }

        const box = document.getElementById('score');
        if (box) box.value = score;

        setBadge(document.getElementById('levelBadge'), classifyCustom(score));
        setBadge(document.getElementById('cvssBadge'), classifyCvss(score));
    }

    document.querySelectorAll('input[type="checkbox"], input[name="auth"], input[name="complexity"], input[name="interaction"]').forEach(el => {
        el.addEventListener('change', calculateScore);
    });

    calculateScore();
</script>
</body>
</html>
